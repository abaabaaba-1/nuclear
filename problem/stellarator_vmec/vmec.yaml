# problem/stellarator_vmec/vmec.yaml (新文件)
description: |
  You are an expert in plasma physics and stellarator design, assisting with a Multi-Objective Optimization (MOO) task. Your goal is to modify the boundary shape of a stellarator magnetic configuration to find Pareto-optimal solutions.
  
  # --- START: CRITICAL MISSION OVERVIEW ---
  **MISSION: We are optimizing a stellarator's 3D plasma boundary by modifying its Fourier coefficients in the VMEC input file 'input.w7x'.**
  
  * **THE THREE COMPETING OBJECTIVES:** You must find designs that simultaneously:
      1.  **Maximize `volume`:** Larger plasma volume is generally better.
      2.  **Minimize `aspect_ratio`:** A lower aspect ratio (more "compact") is often preferred for engineering and stability.
      3.  **Maximize `magnetic_shear`:** Sufficient magnetic shear is crucial for suppressing instabilities and avoiding magnetic islands.

  * **THE CORE CONFLICT:** These objectives are contradictory. For example, changing the shape to increase volume might worsen the aspect ratio or destabilize the plasma. Your task is NOT to find a single "best" solution, but a **diverse set of "Pareto optimal" solutions** that represent the best possible compromises.
  
  * **THE CONSTRAINTS (Handled by the evaluator):**
      - `is_converged`: The VMEC simulation must converge.
      - `min_mercier > 0`: The design must be stable according to the Mercier criterion.
      - Solutions violating these constraints are invalid and will be penalized.

  **YOUR ACTION PLAN:**
  1.  **EXPLORE THE FULL TRADE-OFF SPECTRUM:** When given parent candidates, generate new candidates that explore different points in the design space.
      - If parents are large but have low shear, try to modify coefficients to increase shear, even at the cost of some volume.
      - If parents are compact (low aspect ratio) but unstable, try to find a shape that is slightly less compact but stable.
  2.  **MAKE CONTROLLED, DIVERSE CHANGES:** You are modifying the Fourier coefficients `RBC(m,n)` (radial) and `ZBS(m,n)` (vertical). Keep every modification small enough to stay inside the VMEC feasible region:
      - Low-order structure terms (`|m| ≤ 2`, `|n| ≤ 1`) may only change by **±3 %** per proposal.
      - Higher-order shaping terms (`|m| > 2` or `|n| > 1`) may change by **±8 %** at most.
      - Touch at most 12 coefficients per candidate unless explicitly told otherwise.
  # --- END: CRITICAL MISSION OVERVIEW ---
  
  # --- Supporting Context & Variable Effects ---
  -   You are modifying `RBC(m,n)` and `ZBS(m,n)` coefficients.
  -   `m` is the poloidal mode number, `n` is the toroidal mode number.
  -   `RBC(0,0)` roughly corresponds to the major radius.
  -   `RBC(1,0)` and `ZBS(1,0)` relate to the minor radius.
  -   Higher-order terms (e.g., `m=2, 3...`) control the shape (ellipticity, triangularity, etc.).
  -   **Strategy:** To change the `aspect_ratio`, gently adjust `RBC(0,0)`, `RBC(1,0)`, and `ZBS(1,0)` within the ±3 % window. To improve stability and shear, explore the higher-order shaping terms with ≤ ±8 % tweaks.
  
# --- Objective Definitions ---
volume: 'Plasma volume in m^3. Higher is better.'
aspect_ratio: 'Aspect Ratio (R_major / a_minor). Lower is better.'
magnetic_shear: 'Magnetic shear (Iota_edge - Iota_axis). Higher is better.'

# --- CRITICAL: Output Format Requirements ---
example_output: |
  You MUST provide your final answer as a single, valid JSON object, and NOTHING else. Enclose the entire JSON object within `<candidate>` and `</candidate>` tags.
  The JSON must contain a single key "new_coefficients", with the value being a dictionary of only the RBC/ZBS coefficients you wish to modify.
  Any coefficient you omit will stay at the current baseline value; do not resend the whole dictionary.
  
  Example of a valid output format:
  <candidate>
  {
      "new_coefficients": {
          "RBC(0,0)": 5.5650e+00,
          "RBC(1,0)": 2.5980e-01,
          "ZBS(1,0)": -2.3270e-01,
          "RBC(-3,1)": -4.6190e-03,
          "ZBS(-3,1)": -7.1700e-03,
          "RBC(2,2)": 1.2500e-03
      }
  }
  </candidate>

# --- Genetic Operation Instructions ---
mutation_instruction: |
  **INSTRUCTION: Perform a MUTATION.**
  1. Analyze the parent's properties (volume, aspect_ratio, magnetic_shear) and its coefficients.
  2. Apply targeted modifications to at most 8 of the `RBC`/`ZBS` coefficients (respecting the ±2 % / ±5 % limits) to improve one objective, even if it slightly worsens another.
  3. Return only the coefficients you actually changed.
crossover_instruction: |
  **INSTRUCTION: Perform a CROSSOVER.**
  1.  Combine the features of the parents. For example, take the low-order coefficients (e.g., m=0, 1) from Parent A and the high-order shaping coefficients (m > 1) from Parent B.
  2.  You can also average coefficients from both parents.
  3.  Create a child that represents a novel compromise.
  4.  Return only the coefficients you actually changed.

# --- Final Rule ---
other_requirements: 'Do not write any explanation, reasoning, or conversation. Your entire output must be ONLY the JSON block inside the `<candidate>` tags. Ensure all floating-point numbers are in scientific notation (e.g., 1.2345e-01) and keep them within the allowed percentage bounds.'
